extends CharacterBody3D

const SPEED = 3.0
const CHANGE_DIR_TIME = 3.0

var direction := Vector3.FORWARD
var timer := 0.0

func _ready():
	randomize()

func _physics_process(delta):
	timer += delta
	if timer >= CHANGE_DIR_TIME:
		timer = 0.0
		_change_direction()
	
	# Horizontal movement
	velocity.x = direction.x * SPEED
	velocity.z = direction.z * SPEED
	
	# Apply gravity (negative Y)
	if not is_on_floor():
		velocity.y += -ProjectSettings.get_setting("physics/3d/default_gravity") * delta
	else:
		velocity.y = 0
	
	# Move the NPC
	move_and_slide()

func _change_direction():
	var angle = randf() * PI * 2
	direction = Vector3(sin(angle), 0, cos(angle))
	look_at(global_transform.origin + direction, Vector3.UP)
